---
title: "Production industrielle mensuelle de glaces et sorbets (1990-2023)"
author: "ANDRU Kilian - LACOUR Xavier"
date: "Mardi 9 mai 2023"
output: html_notebook
---
### ANDRU Kilian - LACOUR Xavier



### Téléchargement et formatage du fichier

Définition de l'espace de travail puis téléchargement de la série.
```{r}
rm(list = objects())

# Xavier - Ordinateur ENSAE
# path <- "W:/Bureau/S4_ENSAE/STL"     

# Xavier - Ordinateur perso
path <- "D:/Etudes/ENSAE/S4/Séries temporelles linéaires/Projet"  

# Kilian - Ordinateur perso
#path <- "C:/Users/Kilian/Desktop/ENSAE/S4/LTS/Projet---S-rie-temporelle-lin-aire"

setwd(path)

library(readr)
donnees_choco <- read.csv("valeurs_mensuelles_chocolat.csv", sep = ";", col.names = c("Periode", "Indice", "Code"))
```

On supprime les trois premieres lignes inutiles.
```{r}
donnees_choco = donnees_choco[-c(1,2,3), ]
```

On vérifie que la colonne Code ne prend que la valeur "A" et que donc l'ensemble des valeurs sont normales
```{r}
if(any(donnees_choco["Code"] != "A") == F){
  donnees_choco = subset(donnees_choco, select = c("Periode", "Indice"))
}
```

On transforme la colonne Indice en valeurs numériques
```{r}
donnees_choco["Indice"] = as.numeric(unlist(donnees_choco["Indice"]))
```

Possibilité d'enlever les données d'après mars 2020 pour ne pas subir les perturbation du Covid-19 (On enlève si covid_garde = FALSE)
```{r}
covid_garde = FALSE
if(covid_garde == FALSE){donnees_choco = donnees_choco[-c(363:length(donnees_choco$Indice)), ]}
```

Convertion en format zoo (Si besoin : "install.packages('zoo')" et "install.packages('tseries')")
```{r}
require(zoo)
require(tseries)

choco <- zoo(donnees_choco["Indice"])
T <- length(choco)
```

## Partie I

### Question 1

Voir rapport de projet.

### Question 2

Vérifions qu'il n'y a pas de tendance linéaire.

```{r}
library(dplyr)
donnees_choco_reg <-  select(donnees_choco, "Indice")
donnees_choco_reg["temps"] <-  0:(T-1)
summary(lm(Indice~., data = donnees_choco_reg))
```



```{r}
acf(choco)
pacf(choco)
```

On remarque que la différence la plus présente est de 1. Donc on différentie à l'ordre 1.

```{r}
choco2 = diff(choco, 1)
acf(choco2)

```

```{r}
choco3 = diff(choco2, 23)
acf(choco3)

```



### Question 3

```{r}
# Indice originel
plot(choco, xaxt = "n", xlab ="Temps (en mois)", ylab = "Valeur mensuelle de l'indice", main = "Evolution de l'indice de production originel depuis 1990")

# Indice stationnarisé

plot(choco2, xaxt = "n", xlab ="Temps (en mois)", ylab = "Valeur mensuelle de l'indice", main = "Evolution de l'indice de production stationnarisé depuis 1990")

```

### Question 4

```{r}
pp.test(choco)
pp.test(choco2)

kpss.test(choco2, null = "Level")
kpss.test(choco)
```

```{r}

```
